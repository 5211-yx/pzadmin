import{u as A,o as H,m as O,a as P,d as $,r as p,b as V,c as G,e as y,f as h,g as l,h as J,w as a,i as _,t as C,j as c,F as z,k as K,l as Q,p as W,E as X,n as Z,q as ee,s as oe,v as le,x as te}from"./index-C1gSipIY.js";import{E as ae,a as ne,b as se,c as ie,d as re,e as ue,f as me}from"./index-Qug-7jGG.js";const de={class:"flex-box"},pe={style:{"margin-left":"10px"}},_e={class:"pagination-info"},ce={class:"dialog-footer"},Ve={__name:"index",setup(fe){const E=A();console.log(E,"route"),H(()=>{m(),O().then(({data:t})=>{console.log("***",t),f.value=t.data})});const m=()=>{P(r).then(({data:t})=>{console.log(t,"authAdmin");const{list:e,total:i}=t.data;e.forEach(n=>{n.create_time=$(n.create_time).format("YYYY-MM-DD")}),d.list=e,d.total=i})},d=p({list:[],total:0}),r=p({pageNum:1,pageSize:10}),f=V([]),N=t=>{const e=f.value.find(i=>i.id===t);return e?e.name:"超级管理员"},S=t=>{r.pageSize=t,m()},U=t=>{r.pageNum=t,m()},u=V(!1),B=()=>{u.value=!1},D=p({name:[{required:!0,trigger:"blur",message:"请填写昵称"}],permissions_id:[{required:!0,trigger:"blur",message:"请选择菜单权限"}]}),k=V(),s=p({name:"",permissions_id:""}),F=async t=>{t&&await t.validate((e,i)=>{if(e){const{name:n,permissions_id:g}=s;Q({name:n,permissions_id:g}).then(({data:b})=>{b.code===1e4&&(u.value=!1,m())})}else console.log("error submit",i)})},T=t=>{u.value=!0,Object.assign(s,{mobile:t.mobile,name:t.name,permissions_id:t.permissions_id})};return(t,e)=>{const i=W,n=ae,g=ne,b=G("Clock"),Y=X,x=Z,j=se,q=ie,w=ee,v=oe,I=me,L=re,M=le,R=ue;return y(),h(z,null,[l(i,{route:J(E)},null,8,["route"]),l(j,{data:d.list,style:{width:"100%"}},{default:a(()=>[l(n,{prop:"id",label:"id"}),l(n,{prop:"name",label:"昵称"}),l(n,{prop:"permissions_id",label:"所属组别"},{default:a(o=>[_(C(N(o.row.permissions_id)),1)]),_:1}),l(n,{prop:"mobile",label:"手机号"}),l(n,{prop:"active",label:"状态"},{default:a(o=>[l(g,{type:o.row.active?"success":"danger"},{default:a(()=>[_(C(o.row.active?"正常":"失效"),1)]),_:2},1032,["type"])]),_:1}),l(n,{label:"创建时间"},{default:a(o=>[c("div",de,[l(Y,null,{default:a(()=>[l(b)]),_:1}),c("span",pe,C(o.row.create_time),1)])]),_:1}),l(n,{label:"操作"},{default:a(o=>[l(x,{type:"primary",onClick:ge=>T(o.row)},{default:a(()=>e[6]||(e[6]=[_("编辑")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),c("div",_e,[l(q,{"current-page":r.pageNum,"onUpdate:currentPage":e[0]||(e[0]=o=>r.pageNum=o),"page-size":r.pageSize,background:!1,size:"small",layout:"total, prev, pager, next",total:d.total,onSizeChange:S,onCurrentChange:U},null,8,["current-page","page-size","total"])]),l(R,{modelValue:u.value,"onUpdate:modelValue":e[5]||(e[5]=o=>u.value=o),"before-close":B,title:"添加权限",width:"500"},{footer:a(()=>[c("div",ce,[l(x,{type:"primary",onClick:e[4]||(e[4]=o=>F(k.value))},{default:a(()=>e[7]||(e[7]=[_("确认")])),_:1})])]),default:a(()=>[l(M,{ref_key:"formRef",ref:k,"label-width":"100px","label-position":"left",model:s,rules:D},{default:a(()=>[l(v,{label:"手机号",prop:"mobile"},{default:a(()=>[l(w,{modelValue:s.mobile,"onUpdate:modelValue":e[1]||(e[1]=o=>s.mobile=o),disabled:""},null,8,["modelValue"])]),_:1}),l(v,{label:"昵称",prop:"name"},{default:a(()=>[l(w,{modelValue:s.name,"onUpdate:modelValue":e[2]||(e[2]=o=>s.name=o)},null,8,["modelValue"])]),_:1}),l(v,{label:"菜单权限",prop:"permissions_id"},{default:a(()=>[l(L,{modelValue:s.permissions_id,"onUpdate:modelValue":e[3]||(e[3]=o=>s.permissions_id=o),placeholder:"请选择菜单权限",style:{width:"240px"}},{default:a(()=>[(y(!0),h(z,null,K(f.value,o=>(y(),te(I,{key:o.id,label:o.name,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])],64)}}};export{Ve as default};
